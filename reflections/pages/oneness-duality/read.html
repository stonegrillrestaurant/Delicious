<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Oneness & Duality -- Ninox Antolihao</title>
<link rel="icon" href="/reflections/assets/favicon.ico">
<style>
.back-button {
  text-align: center;
  margin: 40px 0;
}

.back-button a {
  background: #ff6b3d;      /* üî∏ Bright orange background */
  color: #ffffff;            /* üî∏ White font */
  text-decoration: none;
  font-weight: 600;
  padding: 10px 24px;
  border-radius: 8px;
  box-shadow: 0 3px 6px rgba(0,0,0,0.25);
  transition: all 0.3s ease;
}

.back-button a:hover {
  background: #e65c2c;       /* Darker orange on hover */
  transform: translateY(-2px);
}

body{
  font-family:'Georgia',serif;
  background:#fffdf9;
  color:#3b2b26;
  margin:0;
  line-height:1.8;
  padding:40px 10%;
}

/* üîí Sticky header so it stays visible while scrolling */
header{
  position: sticky;
  top: 0;
  z-index: 1000;
  background:#fffdf9;
  text-align:center;
  padding-top:18px;
  padding-bottom:14px;
  margin-bottom:40px;
  border-bottom:1px solid #e6d2b5;
  box-shadow: 0 2px 6px rgba(0,0,0,0.04);
}
header h1{font-size:2.2rem;margin-bottom:8px;margin-top:8px;}
header h2{font-size:1.2rem;font-weight:normal;color:#7b5f54;margin:4px 0;}
header p{margin:2px 0;color:#9c7e74;}

h3{margin-top:40px;text-align:center;border-top:1px solid #e6d2b5;
    padding-top:20px;color:#5a392e;font-weight:bold;}
p{text-align:justify;margin:14px 0;font-size:1.05rem;}
blockquote{
  font-style:italic;
  color:#5f4b43;
  border-left:4px solid #d8b88f;
  padding-left:14px;
  margin:20px 0;
  background:#f8efe5;
  border-radius:4px;
}
.center{text-align:center;margin:28px 0;line-height:1.8;}
.divider{text-align:center;color:#c9a874;margin:26px 0;font-size:1.1rem;}
footer{
  text-align:center;
  margin-top:60px;
  font-size:0.9rem;
  color:#a38b7b;
  border-top:1px solid #e0d4c6;
  padding-top:20px;
}
@media(max-width:720px){
  body{padding:28px 6%;}
  header h1{font-size:1.8rem;}
}
  /* =========================
       AUDIO PLAYLIST (tighter)
    ========================== */
    .audio-wrap{
      max-width:800px;
      margin:1.2rem auto 1.2rem auto;
      padding:0.85rem 0.75rem;
      border-radius:16px;
      background:#261a15;
      border:3px solid rgba(101,55,14,1);
    }

    #reflectionAudio{
      width:100%;
      display:block;
    }

    .playlist{
      margin-top:0.9rem;
      display:flex;
      flex-direction:column;
      gap:0.4rem;
    }

    .playlist-row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:0.55rem 0.55rem;
      background:#261a15;
      border-radius:8px;
      cursor:pointer;
      border:1.5px solid #120d09;
      transition: background 0.15s ease, border-color 0.15s ease, color 0.15s ease;
    }

    .playlist-row:hover{ border-color:#42251c; }

    .playlist-row.active{
      background:#170d09;
      border-color:#997060;
      box-shadow:0 0 2px rgba(255,0,0,0.4);
    }

    .playlist-main{
      display:flex;
      flex-direction:column;
      gap:0rem;
      overflow:hidden;
    }

    .playlist-title{
      font-size:0.96rem;
      font-weight:600;
      color:#f3e6dd;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .playlist-sub{
      font-size:0.78rem;
      color:#b29587;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .playlist-duration{
      font-size:0.82rem;
      color:#c9b0a4;
      margin-left:0.75rem;
      flex-shrink:0;
    }
</style>
</head>
<body>

<header>
  <!-- AUDIO PLAYER + PLAYLIST -->
      <section class="audio-wrap">
        <div class="audio-wrapper">
          <audio id="reflectionAudio" controls preload="metadata">
            <source id="audioSource" src="" type="audio/mpeg">
            Your browser does not support the audio element.
          </audio>

          <div class="playlist">
            <div class="playlist-row active" data-src="/oneness-duality/onenessduality.mp3">
              <div class="playlist-main">
                <div class="playlist-title">The Subconscious Mind</div>
                <div class="playlist-sub">The Silent Architech of your soul.</div>
              </div>
              <div class="playlist-duration">--:--</div>
            </div>

            <div class="playlist-row" data-src="/reflections/pages/oneness-duality/onenessduality.mp3">
              <div class="playlist-main">
                <div class="playlist-title">Oneness and Duality</div>
                <div class="playlist-sub">The Ethical Weight of a Flawed Design</div>
              </div>
              <div class="playlist-duration">--:--</div>
            </div>
          </div>
        </div>
      </section>
  <p>First Edition -- 2025</p>
</header>

<main id="readContent">
<section>
<h3>A Journey from Duality to Oneness</h3>
<p>Today's conversation charted a fascinating course through philosophy, theology, and psychology, ultimately converging on a single, profound idea: that duality--the perceived separation between the self and the world--is a tool of consciousness, and its misidentification as ultimate reality is the root of human suffering</p>
<p>The journey began by questioning the provability of religious claims. We concluded that the skeptical thesis, "man created God in his own image," is the most provable explanation for theological contradictions, as it accounts for the observable fact that religious rules and concepts are merely human, cultural, and historical projections. This led us directly to the concept of duality.</p>
<p>The concept of Oneness is not a religious doctrine or a philosophical abstraction; it is, in the view of many mystical traditions and modern physics, the fundamental, seamless reality underlying the universe. It is the understanding that all apparent diversity--every star, every human, every thought--is a temporary manifestation of a single, unified field of consciousness and energy. This realization challenges the core mechanism of human survival: the dualistic ego.</p>
<p>The Illusion of the "I".</p>
<p>The human mind, wired for survival, operates by creating and maintaining boundaries. It defines the world through a constant dualistic calculus: "I" vs. "Other," "Good" vs. "Bad," "Safe" vs. "Threat." This functional separation, necessary for navigating the physical world, solidifies into the belief that the "I"--the ego--is an isolated entity.</p>
<p>This belief in separation is the root of the world's greatest problems. It creates the logic for selfishness, as the needs of the "I" are prioritized over the "Other." It fuels conflict, as my group's welfare is deemed separate from yours. It makes dogma contradictory, as a separate, personal God is imagined with human-like, dualistic flaws. In short, the ego, the dualistic agent of survival, mistakes its tool for the ultimate truth, trapping consciousness in a web of internal and external conflict.</p>

<p>The core of the problem, we established, lies in the dualistic structure of the human mind. Our brains, designed primarily as survival engines, create a necessary division: "I" versus "Not-I" (the external world). This separation, which is crucial for navigation and survival, is the origin of the ego.</p>
<p>To resolve these contradictions, we embraced the non-dual perspective, realizing that duality is not reality; it is merely a tool.</p>
<p>Duality functions as the mechanism through which consciousness explores itself. It is not the enemy of unity, but the servant of realization. Through the perception of opposites, awareness sharpens its sense of being.</p>
<p><strong>Light</strong> can only be known through the existence of <strong>darkness</strong>. <strong>Truth</strong> reveals itself against the background of <strong>falsehood</strong>. This dance of opposites allows the One to become aware of itself as both observer and observed.</p>

<blockquote>"The universe learns itself by dividing itself in two." -- Ninox Antolihao</blockquote>

<div class="divider">-- ‚ùñ --</div>

<h4>Oneness isn't the opposite of Duality</h4>
<p>Oneness and Duality are not two opposing truths but one continuous reality seen from two lenses. Duality is the movement of the One--it is the way the Infinite experiences itself as form. Without contrast, nothing can be known; without Oneness, contrast has no ground to exist.</p>

<p>Just as the ocean expresses itself through waves, Oneness expresses itself through Duality. The wave appears separate, but its essence is water. Likewise, all experiences--light and dark, life and death, joy and pain--are not enemies but rhythmic pulsations of one universal essence.</p>
<p>Oneness is the ultimate reality--the single, undivided, supra-logical Consciousness from which all experience emerges. It is the hardware upon which the dualistic operating system runs.
: All the world's problems--from ethical failures to mental distress--are not inherent to existence but are a consequence of a lack of balance, where the dualistic self-focus of the "I" overrides the unifying truth of Oneness.</p>

<div class="divider">-- ‚ùñ --</div>

<h3>ONENESS AS THE GROUND OF BEING</h3>
<p>Behind every motion lies stillness. Behind every form, the formless. Oneness is that silent field from which all dualities arise and into which all dissolve. It is the space in which Duality acts, just as silence is the space in which sound appears.</p>
<p>To realize Oneness is not to destroy Duality, but to see it as an expression of the same eternal substance. The opposites do not vanish; they are understood as complementary halves of one truth.</p>
<p>The most profound realization of the conversation was the distinction between the Relative Self and the Absolute Self:</p>
<p>The "Who We Are" is the dualistic identity--the personality, the ego, the role, the moral code--which is temporary and changeable. This is where most religions and human effort are focused.</p>
<p>The "What We Are" is the Absolute Self--the unchanging, perfect, non-dual Awareness that is the substance of the universe. This is what we ultimately cannot change.</p>
<p>The goal of wisdom, therefore, is not to destroy the necessary tool of duality, but to simply remember the truth of Oneness while living in the world of separation. We must use the dualistic "I" for functional survival, but we must govern it with the awareness that "I am all that is."</p>
<p>Reflection:</p>
<p>The conversation on duality is a profound call for a shift in perspective. To realize that the foundational structure of our world--the distinction between "me" and "not-me"--is merely an evolutionary tool for survival is to gain access to a deeper, ethical truth.
</p>
<p>The insight gained is not that we should abandon duality; that would be impossible, as we need the separate "I" to navigate, eat, and function. The realization is that we must never mistake the map for the territory. Duality is the map of relative functionality; Oneness is the territory of absolute reality.</p>
<p>Our task in life, therefore, is to maintain the necessary dualistic function (to act, decide, and survive) while holding the non-dual awareness (that the other person is me). This shift moves life from a competitive battle to a harmonious flow. It dismantles the logic of selfishness and transforms ethical behavior from a duty driven by fear into a spontaneous, logical act of self-love applied to the Universal Self. The ultimate wisdom lies in using the "I" to serve the "Everything."</p>

<div class="divider">-- ‚ùñ --</div>

<h3>The " I " (ego)</h3>
<p>The mind, through conditioning, identifies with one half of Duality--preferring light over dark, good over evil, life over death. This selective perception creates the illusion of a separate "I." Yet when awareness observes even this preference, it begins to awaken from illusion.</p>
<p>The ego is not destroyed through denial but through understanding. It is a temporary structure that allows consciousness to play within form. Once its role is seen, its power to imprison fades.</p>

<div class="divider">-- ‚ùñ --</div>

<h3>THE SEAMLESS REALITY OF ONENESS</h3>
<p>When all opposites are understood as necessary to the Whole, perception shifts from resistance to reverence. Life ceases to be a problem to solve and becomes a mystery to experience.</p>
<p><em>Duality is not the absence of Oneness; it is its reflection through experience.</em> The two are one continuum--movement and stillness, action and awareness, time and eternity--all within the same divine field.</p>

<div class="divider">-- ‚ùñ --</div>

<h3>REALIZATION</h3>
<p>True realization is not escape from Duality but harmony within it. It is the calm acceptance that joy and sorrow, gain and loss, birth and death are all movements within the same stillness.</p>
<p><strong>Oneness is the space where Duality acts.</strong> To live consciously is to let both exist--action within peace, form within formlessness, self within Self.</p>
<p>To awaken is to remember: there is only one Self appearing as all beings. The same light that animates you animates the stars, the trees, and every beating heart. Oneness is not found by seeking; it is revealed by the quiet seeing of what already is.</p>

<blockquote>"You are not a drop in the ocean; you are the ocean looking at itself through a drop." -- Ninox Antolihao</blockquote>

<div class="divider">-- ‚ùñ --</div>

<h3>ABOUT THE AUTHOR</h3>
<p><strong>Ninox Antolihao</strong> is a Filipino thinker and writer exploring the meeting point of spirituality, science, and self-awareness. His reflections seek to awaken understanding rather than belief, reminding readers that truth is not owned but realized.</p>
<p>Through Stone Grill Press, he shares reflections that weave philosophy, psychology, and lived experience into one voice--gentle yet clear--urging humanity to rediscover the unity beneath apparent separation.</p>

<blockquote>"Awareness is the bridge between Oneness and Duality." -- Ninox Antolihao</blockquote>

</section>
</main>
  <div class="ref-divider">------ ‚ùñ ------</div>
      <!-- COMMENTS (Cusdis) -->
<section class="comments-wrap" aria-label="Comments">
  <h3>Leave a message</h3>

  <div id="cusdis_thread"
    data-host="https://cusdis.com"
    data-app-id="d14e9b16-d8b2-40ac-a7f6-e200b1ac61e8"
    data-theme="light"
    data-page-id=""
    data-page-url=""
    data-page-title=""
  ></div>
</section>

<script>
  (function () {
    const el = document.getElementById("cusdis_thread");
    if (!el) return;
    el.setAttribute("data-page-id", location.pathname);
    el.setAttribute("data-page-url", location.href);
    el.setAttribute("data-page-title", document.title);
  })();
</script>

<script async defer src="https://cusdis.com/js/cusdis.es.js"></script>

<script>
  // Force LIGHT theme inside the comment box (more reliable)
  (function setCusdisTheme(){
    function apply() {
      if (window.CUSDIS && typeof window.CUSDIS.setTheme === "function") {
        window.CUSDIS.setTheme("light");
        return true;
      }
      return false;
    }
    if (apply()) return;
    let tries = 0;
    const t = setInterval(() => {
      tries++;
      if (apply() || tries > 40) clearInterval(t);
    }, 150);
  })();
</script>

<footer>
  <p>Stone Grill Press ¬∑ Leyte, Philippines ¬∑ ¬© 2025 Ninox Antolihao<br>First Edition -- 2025</p>
</footer>

<!-- ===== Floating TTS Reader (drop-in) ===== -->
<style>
  /* Floating button */
  #ttsFab{
    position:fixed; right:18px; bottom:18px; z-index:9999;
    width:52px; height:52px; border-radius:50%;
    display:flex; align-items:center; justify-content:center;
    background:var(--accent, #ff6a3d); color:#000; border:none; cursor:pointer;
    box-shadow:0 10px 28px rgba(0,0,0,.35); font-weight:700;
  }
  #ttsFab:active{ transform:translateY(1px); }

  /* Panel */
  #ttsPanel{
    position:fixed; right:18px; bottom:84px; z-index:9999;
    width:320px; max-width:90vw;
    background:var(--paper, #29211e); color:var(--ink, #f3e6dd);
    border:1px solid #3a2f2b; border-radius:14px; overflow:hidden;
    box-shadow:0 12px 36px rgba(0,0,0,.4);
    display:none;
  }
  #ttsHead{
    display:flex; align-items:center; justify-content:space-between;
    padding:10px 12px; background:linear-gradient(180deg,#2e2522,#231b18);
    border-bottom:1px solid #3a2f2b;
  }
  #ttsHead strong{ font-size:14px; letter-spacing:.3px; }
  #ttsClose{ background:none; border:none; color:inherit; font-size:18px; cursor:pointer; }

  #ttsBody{ padding:12px; display:grid; gap:10px; }
  #ttsControls{ display:flex; gap:8px; flex-wrap:wrap; }
  #ttsControls button{
    flex:1 1 auto; min-width:78px;
    padding:8px 10px; border-radius:10px; border:1px solid #4a3b35; background:#2d231f;
    color:inherit; cursor:pointer;
  }
  #ttsControls button:disabled{ opacity:.5; cursor:not-allowed; }
  #ttsRow{ display:grid; grid-template-columns:1fr 110px; gap:8px; }
  #ttsBody select, #ttsBody input[type="range"]{
    width:100%; background:#211a17; color:inherit; border:1px solid #4a3b35; border-radius:8px; padding:8px;
  }
  #ttsNote{
    font-size:12px; color:var(--muted,#c9b0a4); line-height:1.4;
    border-top:1px dashed #3a2f2b; padding-top:8px;
  }

  /* Sentence highlight */
  .tts-current{
    background:rgba(255,106,61,.22);
    box-shadow:0 0 0 2px rgba(255,106,61,.15) inset;
    border-radius:6px;
    transition:background .2s ease;
  }
</style>

<button id="ttsFab" aria-label="Listen">‚ñ∂Ô∏é</button>

<div id="ttsPanel" role="dialog" aria-label="Text to Speech Reader">
  <div id="ttsHead">
    <strong>Reader ‚Äî ‚ùñ ‚Äî</strong>
    <button id="ttsClose" aria-label="Close">√ó</button>
  </div>
  <div id="ttsBody">
    <div id="ttsRow">
      <select id="ttsVoice" aria-label="Voice"></select>
      <label style="display:flex;align-items:center;gap:8px;">
        <span style="font-size:12px;opacity:.85;white-space:nowrap;">Speed</span>
        <input id="ttsRate" type="range" min="0.7" max="1.4" step="0.05" value="1" />
      </label>
    </div>

    <div id="ttsControls">
      <button id="ttsPlay">Play</button>
      <button id="ttsPause" disabled>Pause</button>
      <button id="ttsStop" disabled>Stop</button>
      <button id="ttsPrev" disabled>‚óÄÔ∏é Prev</button>
      <button id="ttsNext" disabled>Next ‚ñ∂Ô∏é</button>
    </div>

    <div style="display:flex;gap:8px;">
      <button id="ttsReadSel" style="flex:1;">Read Selection</button>
      <button id="ttsReadAll" style="flex:1;">Read All</button>
    </div>

    <div id="ttsNote">
      Tip: On iPhone/iPad, tap <em>Play</em> once to unlock audio (Safari requires a user gesture).
      The reader highlights each sentence as it speaks.
    </div>
  </div>
</div>

<script>
(function(){
  const area = document.querySelector('#readContent') || document.querySelector('main') || document.body;
  const synth = window.speechSynthesis;
  const supportsTTS = !!synth;

  const el = {
    fab: document.getElementById('ttsFab'),
    panel: document.getElementById('ttsPanel'),
    close: document.getElementById('ttsClose'),
    voice: document.getElementById('ttsVoice'),
    rate: document.getElementById('ttsRate'),
    play: document.getElementById('ttsPlay'),
    pause: document.getElementById('ttsPause'),
    stop: document.getElementById('ttsStop'),
    prev: document.getElementById('ttsPrev'),
    next: document.getElementById('ttsNext'),
    readSel: document.getElementById('ttsReadSel'),
    readAll: document.getElementById('ttsReadAll'),
  };

  if(!supportsTTS){
    el.fab.style.display='none';
    console.warn('Speech Synthesis not supported in this browser.');
    return;
  }

  // State
  let voices = [];
  let chunks = [];       // [{el:span, text:string}]
  let idx = -1;
  let speaking = false;
  let paused = false;

  // ---- UI wiring
  el.fab.onclick = ()=> { el.panel.style.display = (el.panel.style.display==='block'?'none':'block'); };
  el.close.onclick = ()=> { el.panel.style.display='none'; };

  el.play.onclick = startOrResume;
  el.pause.onclick = pauseSpeech;
  el.stop.onclick = stopSpeech;
  el.prev.onclick = ()=> jump(-1);
  el.next.onclick = ()=> jump(+1);
  el.readSel.onclick = ()=> begin(true);
  el.readAll.onclick = ()=> begin(false);

  el.rate.oninput = ()=>{ localStorage.setItem('ttsRate', el.rate.value); };
  el.voice.onchange = ()=>{ localStorage.setItem('ttsVoiceName', el.voice.value); };

  // Persisted settings
  const savedRate = localStorage.getItem('ttsRate');
  if(savedRate) el.rate.value = savedRate;

  // ---- Voice loading
  function loadVoices(){
    voices = synth.getVoices().sort((a,b)=> (a.lang||'').localeCompare(b.lang||'') || (a.name||'').localeCompare(b.name||''));
    el.voice.innerHTML = '';
    voices.forEach(v=>{
      const opt = document.createElement('option');
      opt.value = v.name;
      opt.textContent = `${v.name} ‚Äî ${v.lang}`;
      el.voice.appendChild(opt);
    });
    const saved = localStorage.getItem('ttsVoiceName');
    let def = voices.find(v=>v.name===saved)
           || voices.find(v=>/^en-PH/i.test(v.lang))
           || voices.find(v=>/^en-/i.test(v.lang))
           || voices[0];
    if(def){ el.voice.value = def.name; }
  }
  loadVoices();
  if (typeof speechSynthesis !== 'undefined') {
    speechSynthesis.onvoiceschanged = loadVoices;
  }

  // ---- Prepare content into sentence spans
  function splitToSentences(root){
    // Clear previous wrapping
    root.querySelectorAll('span[data-tts]').forEach(s=>{
      const t = document.createTextNode(s.textContent);
      s.replaceWith(t);
    });

    const walker = document.createTreeWalker(root, NodeFilter.SHOW_TEXT, {
      acceptNode(node){
        const t = (node.nodeValue||'').replace(/\s+/g,' ');
        return t.trim() ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_REJECT;
      }
    });

    const nodes = [];
    while(walker.nextNode()) nodes.push(walker.currentNode);

    const sentenceEnd = /([^\s].*?[\.!\?‚Ä¶]+)(\s+|$)/g; // simple sentence chunker

    nodes.forEach(node=>{
      const text = node.nodeValue.replace(/\s+/g,' ');
      let lastIndex = 0;
      const frag = document.createDocumentFragment();
      let match;

      while ((match = sentenceEnd.exec(text)) !== null) {
        const before = text.slice(lastIndex, match.index);
        if(before.trim()){
          frag.appendChild(spanFor(before));
        }
        frag.appendChild(spanFor(match[1]));
        lastIndex = sentenceEnd.lastIndex;
      }
      const tail = text.slice(lastIndex);
      if(tail.trim()){
        frag.appendChild(spanFor(tail));
      }
      node.parentNode.replaceChild(frag, node);
    });

    function spanFor(t){
      const s = document.createElement('span');
      s.textContent = t.trim() + ' ';
      s.setAttribute('data-tts','1');
      return s;
    }
  }

  function harvestChunks(scope){
    chunks = Array.from(scope.querySelectorAll('span[data-tts]')).map(s=>({el:s, text:s.textContent.trim()}))
                   .filter(o=>o.text && o.text.length>0);
  }

  // ---- Reading flows
  function begin(selectionOnly){
    const scope = selectionOnly && window.getSelection && !window.getSelection().isCollapsed
      ? rangeContainer(window.getSelection())
      : area;

    splitToSentences(scope);
    harvestChunks(scope);

    if(chunks.length===0){
      alert('No readable text found.');
      return;
    }
    idx = 0;
    speakCurrent();
    updateButtons();
  }

  function startOrResume(){
    if(!speaking){
      // if nothing queued, treat as "read selection" if user has one, else read all
      const hasSel = window.getSelection && !window.getSelection().isCollapsed;
      begin(hasSel);
      return;
    }
    if(paused){
      synth.resume();
      paused = false;
      updateButtons();
    }
  }

  function pauseSpeech(){
    if(speaking && !paused){
      synth.pause();
      paused = true;
      updateButtons();
    }
  }

  function stopSpeech(){
    synth.cancel();
    clearHighlight();
    speaking = false;
    paused = false;
    idx = -1;
    updateButtons();
  }

  function jump(delta){
    if(!speaking) return;
    synth.cancel();
    clearHighlight();
    idx = Math.max(0, Math.min(chunks.length-1, idx + delta));
    speakCurrent();
  }

  function speakCurrent(){
    if(idx<0 || idx>=chunks.length) { stopSpeech(); return; }

    const rate = parseFloat(el.rate.value || '1') || 1;
    const voice = voices.find(v=>v.name===el.voice.value) || null;

    const {el:node, text} = chunks[idx];
    clearHighlight();
    node.classList.add('tts-current');
    node.scrollIntoView({block:'center', behavior:'smooth'});

    const utt = new SpeechSynthesisUtterance(text);
    if(voice) utt.voice = voice;
    utt.rate = rate;

    utt.onend = ()=>{
      node.classList.remove('tts-current');
      idx++;
      if(idx < chunks.length){
        // slight gap to avoid overlap on some browsers
        setTimeout(speakCurrent, 60);
      }else{
        stopSpeech();
      }
    };
    utt.onerror = (e)=> {
      console.warn('TTS error:', e);
      stopSpeech();
    };

    speaking = true;
    paused = false;
    updateButtons();
    synth.speak(utt);
  }

  function clearHighlight(){
    document.querySelectorAll('.tts-current').forEach(n=> n.classList.remove('tts-current'));
  }

  function updateButtons(){
    const playDisabled = speaking && !paused;
    document.getElementById('ttsPlay').disabled = playDisabled;
    document.getElementById('ttsPause').disabled = !speaking || paused;
    document.getElementById('ttsStop').disabled = !speaking;
    document.getElementById('ttsPrev').disabled = !(speaking && idx>0);
    document.getElementById('ttsNext').disabled = !(speaking && idx<chunks.length-1);
  }

  // Utility: get a Node that contains current selection (or area as fallback)
  function rangeContainer(sel){
    try{
      const range = sel.getRangeAt(0).cloneRange();
      const wrapper = document.createElement('span');
      wrapper.setAttribute('data-tts-scope','1');
      range.surroundContents(wrapper);
      return wrapper;
    }catch(e){
      return area;
    }
  }
  

})();

  // Audio playlist logic
    document.addEventListener('DOMContentLoaded', () => {
      const audioPlayer = document.getElementById('reflectionAudio');
      const audioSource = document.getElementById('audioSource');
      const rows = document.querySelectorAll('.playlist-row');

      // Default track: first row
      if (rows.length > 0) {
        audioSource.src = rows[0].dataset.src;
        audioPlayer.load();
      }

      // Clicking a row switches track
      rows.forEach(row => {
        row.addEventListener('click', () => {
          rows.forEach(r => r.classList.remove('active'));
          row.classList.add('active');

          audioSource.src = row.dataset.src;
          audioPlayer.load();
          audioPlayer.play();
        });
      });

      // Auto-fill durations
      rows.forEach(row => {
        const tempAudio = new Audio(row.dataset.src);
        tempAudio.addEventListener('loadedmetadata', () => {
          const dur = tempAudio.duration;
          if (!isNaN(dur)) {
            const total = Math.floor(dur);
            const min = String(Math.floor(total / 60)).padStart(2, '0');
            const sec = String(total % 60).padStart(2, '0');
            const durEl = row.querySelector('.playlist-duration');
            if (durEl) durEl.textContent = `${min}:${sec}`;
          }
        });
      });
    });

</script>
  
<!-- ===== /Floating TTS Reader ===== -->
</body>
</html>
